{% extends "themes/NeoLearn/includes/modal_generic.html" %}

{% block formModal %}

<form id="formUpdateLesson" method="POST" enctype="multipart/form-data" action="">
    {% csrf_token %}
  <div class="modal-body">

    <!-- T√≠tulo -->
    <div class="form-group">
        <label class="form-label" for="lessonTitle">
            T√≠tulo da Aula
            <span class="required-mark">*</span>
        </label>
        <input type="text" id="lessonTitle" name="title" class="form-input" placeholder="Ex: Introdu√ß√£o ao Django" required>
    </div>
    
    <!-- Tipo de Conte√∫do -->
    <div class="form-group">
        <label class="form-label" for="updateLessonContentType">Tipo de Conte√∫do</label>
        <select id="updateLessonContentType" name="content_type" class="form-select" onchange="updateChangeLessonType(this.value)">
            <option value="video">üé• V√≠deo</option>
            <option value="text">üìÑ Texto</option>
            <option value="quiz">‚ùì Quiz</option>
            <option value="file">üìÅ Arquivo</option>
        </select>
    </div>

    <!-- üîπ Campo: Texto -->
    <div class="update-lesson-content-fields" id="updateLessonTextFields" style="display:none;">
        <div class="form-group">
            <label class="form-label">Conte√∫do em Texto</label>
            <textarea id="lessonContentText" name="content_text" class="form-textarea" rows="6" placeholder="Digite o conte√∫do desta aula..."></textarea>
        </div>
    </div>

    <!-- üîπ Campo: V√≠deo (Apenas 1 v√≠deo permitido) -->
    <div class="update-lesson-content-fields" id="updateLessonVideoFields">

      <div class="video-upload-item">
        
        <label class="form-label">T√≠tulo do V√≠deo</label>
        <input type="text" name="video_title" class="form-input" value="{{ video.title }}" placeholder="Ex: Introdu√ß√£o">
        
        <label class="form-label mt-2">Arquivo de V√≠deo</label>
        <input type="file" name="video_file" class="form-input video-input" accept="video/*">
        <small class="form-hint" id="videoFileNameDisplay">
            {{ video.file.name }}
        </small>
        

  
      <input type="hidden" name="video_duration" class="video-duration-field" value="{{ video.duration|default:0 }}">
      <small id="video-duration-display">
          ‚è±Ô∏è {% if video.duration %}{{ video.duration|floatformat:2 }}{% else %}0:00{% endif %}
      </small>

      </div>

    </div>

    <br>

    <!-- Campo de dura√ß√£o total (s√≥ para v√≠deo) -->
    <input type="hidden" name="duration" id="updateLessonDurationField">

    <!-- üîπ Campo: Quiz -->
    <div class="update-lesson-content-fields" id="updateLessonQuizFields" style="display:none;">
        <div class="form-group">
            <label class="form-label">Pergunta do Quiz</label>
            <input type="text" name="quiz_question" class="form-input" placeholder="Ex: O que √© um template Django?">
        </div>
        <div class="form-group">
            <label class="form-label">Respostas (separe por v√≠rgulas)</label>
            <input type="text" name="quiz_answers" class="form-input" placeholder="View, Template, Model, Admin">
        </div>
    </div>

    <!-- üîπ Campo: Arquivo -->
    <div class="update-lesson-content-fields" id="updateLessonFileFields" style="display:none;">
        <div class="form-group">
            <label class="form-label">Arquivo da Aula</label>
            <input type="file" name="content_file" class="form-input">
            <span class="form-hint">Envie PDFs, imagens ou documentos de apoio</span>
        </div>
    </div>

    <!-- Descri√ß√£o -->
    <div class="form-group">
        <label class="form-label" for="lessonDescription">Descri√ß√£o</label>
        <textarea id="lessonDescription" name="description" class="form-textarea" rows="3"></textarea>
    </div>


    <!-- Ordem e Status -->
    <div class="form-row">
      <div class="form-group">
        <label class="form-label">Ordem</label>
        <input type="number" name="order" id="lessonOrder" class="form-input" min="1" value="1">
      </div>
      <div class="form-group">
        <label class="form-label">Status</label>
        <select name="status" id="lessonStatus" class="form-select">
          <option value="draft">Rascunho</option>
          <option value="published">Publicado</option>
        </select>
      </div>
    </div>
  </div>

    <div class="modal-footer">
        <button type="button" class="btn btn-outline" onclick="closeModal('{{ modal_id }}')">Cancelar</button>
        <button type="submit" class="btn btn-primary">Salvar Altera√ß√µes</button>
    </div>
  </div>
</form>



{% endblock %}
